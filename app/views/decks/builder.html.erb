<script>
  $(document).ready(function() {
    // install place holder card slots
    Holder.run({images: $(".card-img-top").toArray()});

    // toggle tooltips on
    $('[data-toggle="tooltip"]').tooltip();
  });

  // setup the pop up card image
  $(function() {
    $('.modal-pop').on('click', function() {
      event.preventDefault();
      mould_id = $(this).find('img').attr('mould_id')
      version = $(this).find('img').attr('version')
      $('.card-image-modal').attr('src', $(this).find('img').attr('src'));
      $('.card-details').attr('href', `/cards/show/${mould_id}/${version}`);
      $('#card-image-modal').modal('show');
    });
  });
</script>

<style>
@media (min-width: 300px) {
    .card-columns {
        column-count: 3;
    }
}

@media (min-width: 576px) {
    .card-columns {
        column-count: 4;
    }
}

@media (min-width: 768px) {
    .card-columns {
        column-count: 5;
    }
}

@media (min-width: 992px) {
    .card-columns {
        column-count: 6;
    }
}

@media (min-width: 1200px) {
    .card-columns {
        column-count: 10;
    }
}
</style>

</br>
<h2 class="text-center">Deck Builder</h2>

<div class="card-columns">
  <% Array.new(30) do |card_place| %>
  <div class="card">
    <% if @cards.nil? %>
    <img id="card-<%= card_place %>" class="card-img-top" data-src="holder.js/200x300?theme=industrial&auto=yes&text=Empty \n Card" src="">
    <% else %>
    <% card = @cards[card_place] %>
    <a href="#" class="modal-pop">
      <img
        id="card-<%= card_place %>"
        class="card-img-top"
        src="<%= card.image_url %>"
        mould_id="<%= card.mould_id %>"
        version="<%= card.version %>"
        data-toggle="tooltip"
        data-placement="bottom"
        title="<%= card.name %>"
      >
    </a>
    <% end %>
  </div>
  <% end %>
</div>

<div class="modal" id="card-image-modal" tabindex="-1" role="dialog" aria-labelledby="card-image-modal-label" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <a href="" class="card-details" target="_blank">
          <img
            src=""
            class="card-image-modal"
            style="width: 100%;"
            data-toggle="tooltip"
            data-placement="top"
            title="Open Card Details in new tab"
          >
        </a>
      </div>
    </div>
  </div>
</div>
